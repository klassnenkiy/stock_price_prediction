- [Эксперементы](https://colab.research.google.com/drive/16Kgw0fNPv0B6oWXHEPdaxAO-yhAG2ZH7?usp=sharing)
- пайплайн обучения и лучшая из моделей


# Описание построения бейзлайна

Бейзлайн модель, выбранное после проведенных эксперементов, представляет собой **линейную регрессию**, которая пытается предсказать цену закрытия акции на основе исторических данных. Так как именно она показала пока что наилучшие результаты)). Модель использует метод скользящего окна (window-based approach), где для предсказания текущей цены использовались данные о ценах закрытия за предыдущие несколько дней.

### Процесс построения модели:
1. **Данные**: Модель использует исторические данные по цене закрытия акций для нескольких тикеров, а также даты торговли для каждого дня.
2. **Предобработка данных**: 
   - Тикеры, не входящие в список `first_tier_tickers`, фильтруются.
   - Индексы столбца `TRADEDATE` конвертируются в формат `datetime`.
3. **Скользящее окно (windowing)**: Для каждого тикера создаются окна с историей цен закрытия размером в 10 дней. Эти окна используются как входные данные для модели, а следующая цена закрытия (через 10 дней) — как целевая переменная.
4. **Моделирование**: Применяется линейная регрессия для прогнозирования следующей цены закрытия на основе предыдущих 10 дней.
5. **Прогнозирование**: После того как модель обучена на тренировочных данных, она предсказывает будущее поведение цены (на 30 дней вперед), используя последние 10 значений.

# Мотивация выбора метрик

Для оценки качества модели были выбраны следующие метрики:

### 1. **MSE (Mean Squared Error)**:
   - Это среднеквадратичная ошибка, которая измеряет средний квадрат разности между предсказанными и фактическими значениями. Это метрика, которая сильно чувствительна к большим ошибкам, так как они возводятся в квадрат. MSE дает хорошее представление о том, насколько хорошо модель прогнозирует данные.
   - **Мотивация**: MSE полезен для выявления крупных ошибок в модели, и его минимизация помогает уменьшить эффект ошибок, возникающих в дальнем прогнозировании.

### 2. **MAE (Mean Absolute Error)**:
   - Средняя абсолютная ошибка измеряет среднее отклонение прогнозируемых значений от фактических. В отличие от MSE, MAE менее чувствителен к выбросам и дает более "практичное" понимание средней величины ошибки.
   - **Мотивация**: MAE более интерпретируемая метрика, особенно если нужно узнать, в среднем, насколько сильно предсказания отклоняются от реальных значений. Это полезно, когда важна точность в "повседневных" прогнозах, а не в случайных крупных отклонениях.

### 3. **RMSE (Root Mean Squared Error)**:
   - Это корень из MSE, который возвращает ошибку в той же единице измерения, что и исходные данные (в данном случае — цена закрытия). RMSE полезен для того, чтобы увидеть, как сильно модель ошибается в среднем.
   - **Мотивация**: RMSE полезен, так как возвращает ошибку в тех же единицах, что и данные, что позволяет лучше понимать масштаб ошибок в предсказаниях.

### 4. **MAPE (Mean Absolute Percentage Error)**:
   - Это средняя абсолютная процентная ошибка, которая измеряет отклонения предсказанных значений от фактических в процентах. Это полезно для того, чтобы понять, насколько сильно модель ошибается в процентах относительно фактических данных.
   - **Мотивация**: MAPE является полезной метрикой, когда необходимо измерить ошибку в процентах и делать выводы, насколько модель хороша в процентах от ожидаемой цены.

### 5. **R² (R-squared)**:
   - Это коэффициент детерминации, который измеряет, насколько хорошо модель объясняет дисперсию данных. Значение R² варьируется от 0 до 1, где 1 означает, что модель идеально объясняет данные, а 0 — что модель не объясняет ничего из наблюдаемых изменений.
   - **Мотивация**: R² предоставляет хорошее представление о том, насколько хорошо линейная модель справляется с предсказанием цены закрытия, и насколько хорошо она объясняет вариации в данных.

# Анализ результатов

- **SBER, SBERP, ROSN, SIBN** и другие тикеры показывают разные результаты на этих метриках. Важно обратить внимание на следующие моменты:
  
  1. **Высокие значения R²** для многих тикеров (например, **SBERP (0.693)**, **ROSN (0.841)**, **SIBN (0.893)**) указывают на то, что модель объясняет значительную часть изменений в цене, что является положительным результатом.
  
  2. **Высокие значения MSE и RMSE** для некоторых тикеров (например, **LKOH (10477.18)** и **PLZL (66388.1)**) свидетельствуют о том, что предсказания модели могут быть очень неточными в определенные моменты, что также указывает на возможность присутствия выбросов или нестабильности на рынке для этих тикеров.

  3. **Очень низкий MAPE** (например, **SNGS (0.02%)**) и **MAE** для некоторых тикеров показывают, что модель очень точно предсказывает эти акции, что указывает на потенциальную стабильность или меньшую волатильность этих активов.

  4. **Ошибка прогноза на будущее**: Несмотря на наличие хороших результатов на обучающих данных, важно помнить, что прогнозирование на 30 дней вперед часто сопряжено с повышенной неопределенностью. Поэтому важно всегда учитывать риски, особенно для нестабильных рынков или в условиях резких изменений цен.

# Заключение

Модель линейной регрессии дала полезные результаты для ряда тикеров, но имеет свои ограничения в плане прогноза на будущее, особенно для тикеров с высокой волатильностью. Выбор метрик оказался обоснованным, так как они дают всестороннюю картину качества модели, включая как точность, так и способность модели объяснять вариацию в данных.
